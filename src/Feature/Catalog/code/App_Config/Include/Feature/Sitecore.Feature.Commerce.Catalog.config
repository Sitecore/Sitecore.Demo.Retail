<?xml version="1.0"?>

<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/">
    <sitecore>
        <services>
            <configurator type="Sitecore.Feature.Commerce.Catalog.Infrastructure.ServicesConfigurator, Sitecore.Feature.Commerce.Catalog" />
        </services>
        <pipelines>
            <initialize>
                <processor type="Sitecore.Feature.Commerce.Catalog.Infrastructure.Pipelines.InitializeRoutes, Sitecore.Feature.Commerce.Catalog" resolve="true" patch:before="processor[@type='Sitecore.Mvc.Pipelines.Loader.InitializeGlobalFilters, Sitecore.Mvc']" />
            </initialize>
            <httpRequestBegin>
                <!-- This processor sets the context item to the product that is matched to incoming URL parameters. -->
                <processor type="Sitecore.Feature.Commerce.Catalog.Infrastructure.Pipelines.ProductItemResolver, Sitecore.Feature.Commerce.Catalog" resolve="true" patch:before="processor[@type='Sitecore.Pipelines.HttpRequest.ItemResolver, Sitecore.Kernel']" />
            </httpRequestBegin>
        </pipelines>
        <linkManager defaultProvider="sitecore">
            <patch:attribute name="defaultProvider">commerce</patch:attribute>
            <providers>
                <add name="commerce"
                     includeFriendlyName="true"
                     useShopLinks="true"
                     includeCatalog="false"
                     addAspxExtension="false"
                     alwaysIncludeServerUrl="false"
                     encodeNames="true"
                     languageEmbedding="asNeeded"
                     languageLocation="filePath"
                     lowercaseUrls="false"
                     shortenUrls="true"
                     useDisplayName="false"
                     type="Sitecore.Feature.Commerce.Catalog.Infrastructure.Provider.CatalogLinkProvider, Sitecore.Feature.Commerce.Catalog" />
            </providers>
        </linkManager>
    </sitecore>
</configuration>